<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>JobSphere – Talent Dashboard</title>

<style>
    body {
        margin: 0;
        font-family: "Poppins", sans-serif;
        background: #f1f5f9;
    }

    /* ---------- NAVBAR ---------- */
    .navbar {
        background: #ffffff;
        padding: 14px 28px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        position: sticky;
        top: 0;
        z-index: 100;
    }

    .logo {
        font-size: 1.5rem;
        font-weight: 700;
        color: #007bff;
    }

    .nav-links a {
        margin-left: 18px;
        text-decoration: none;
        font-weight: 500;
        color: #333;
        transition: 0.3s;
    }

    .nav-links a:hover {
        color: #007bff;
    }

    /* ---------- HERO ---------- */
    .hero {
        text-align: center;
        padding: 50px 20px;
        background: linear-gradient(135deg, #007bff, #005fcc);
        color: white;
    }

    .hero h2 {
        margin-bottom: 10px;
        font-size: 2rem;
    }

    .search-box input {
        margin-top: 15px;
        width: 55%;
        padding: 12px 16px;
        border-radius: 10px;
        border: none;
        outline: none;
        font-size: 1rem;
    }

    /* ---------- JOB CARD ---------- */
    .job-card {
        background: rgba(255,255,255,0.9);
        backdrop-filter: blur(8px);
        border-radius: 16px;
        padding: 22px;
        margin: 20px auto;
        width: 88%;
        max-width: 780px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        border-left: 4px solid #007bff;
        transition: 0.2s;
        cursor: pointer;
    }

    .job-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 14px rgba(0,0,0,0.15);
    }

    .job-title {
        font-size: 1.4rem;
        color: #007bff;
        font-weight: 600;
    }

    .job-role, .job-location, .job-pay, .job-desc-title {
        font-weight: 600;
        color: #333;
        margin-top: 8px;
    }

    .job-desc {
        margin-top: 6px;
        color: #555;
    }

    /* SKILLS */
    .skills {
        margin-top: 14px;
    }

    .skill-badge {
        display: inline-block;
        background: #e6f0ff;
        color: #005fcc;
        padding: 6px 10px;
        border-radius: 8px;
        margin-right: 8px;
        margin-top: 6px;
        font-size: 0.85rem;
        font-weight: 500;
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

</head>

<body>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="logo">JobSphere</div>
    <div class="nav-links">
        <a href="#">Notifications</a>
        <a href="#">Profile</a>
        <a href="/logout/">Logout</a>
    </div>
</nav>

<!-- HERO -->
<section class="hero">
    <h2>Discover Your Next Opportunity</h2>
    <p>Find jobs that match your skills and goals</p>

    <div class="search-box">
        <input id="searchInput" placeholder="Search jobs by title, skills, role, location..." />
    </div>
</section>

<!-- JOB LIST -->
<div id="job-list"></div>

<script>
function renderJobs(jobs) {
    const container = document.getElementById("job-list");
    container.innerHTML = "";

    if (jobs.length === 0) {
        container.innerHTML = "<p style='text-align:center; margin-top:20px;'>No jobs found.</p>";
        return;
    }

    jobs.forEach(job => {
        let card = document.createElement("div");
        card.classList.add("job-card");

        card.onclick = () => window.location.href = `/job/${job.id}/`;

        let skillsHTML = "";
        (job.needed_skills || []).forEach(s => {
            skillsHTML += `<span class="skill-badge">${s.name}</span>`;
        });

        card.innerHTML = `
            <h3 class="job-title">${job.job_title}</h3>

            <p class="job-role">Role: ${job.job_role.map(r => r.name).join(", ")}</p>
            <p class="job-location">Location: ${job.location?.name || "Remote"}</p>

            <p class="job-pay">Salary: ₹${job.salary_min} - ₹${job.salary_max} ${job.currency}</p>

            <p class="job-desc-title">Description:</p>
            <p class="job-desc">${job.job_description?.slice(0, 150)}...</p>

            <div class="skills"><strong>Skills:</strong><br>${skillsHTML}</div>
        `;

        container.appendChild(card);
    });
}

/* Fetch Jobs */
axios.get("http://127.0.0.1:8000/api/jobs/")
.then(res => {
    let jobs = res.data;

    renderJobs(jobs);

    document.getElementById("searchInput").addEventListener("input", function () {
        const q = this.value.toLowerCase();

        const filtered = jobs.filter(j =>
            j.job_title.toLowerCase().includes(q) ||
            j.job_description?.toLowerCase().includes(q) ||
            j.job_role.some(r => r.name.toLowerCase().includes(q)) ||
            j.location?.name.toLowerCase().includes(q) ||
            j.needed_skills.some(s => s.name.toLowerCase().includes(q))
        );

        renderJobs(filtered);
    });
});

</script>

</body>
</html>
